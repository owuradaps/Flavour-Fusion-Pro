<!-- user_profile.html -->

{% extends 'base.html' %}
{% load static %}

{% block content %}
  <div class="container mt-4">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
          {% if breadcrumb.url %}
            <li class="breadcrumb-item"><a href="{{ breadcrumb.url }}">{{ breadcrumb.title }}</a></li>
          {% else %}
            <li class="breadcrumb-item active" aria-current="page">{{ breadcrumb.title }}</li>
          {% endif %}
        {% endfor %}
      </ol>
    </nav>

    <div class="row">
      <div class="col-md-4">
        {% if profile_user.profile.profile_picture %}
          <img src="{{ profile_user.profile.profile_picture.url }}" alt="Profile Picture" class="img-fluid rounded-circle mb-3">
        {% else %}
          <img src="{% static 'images/default_profile_picture.jpg' %}" alt="Default Profile Picture" class="img-fluid rounded-circle mb-3">
        {% endif %}
        <h3>{{ profile_user.username }}</h3>
        <p>{{ profile_user.profile.bio }}</p>
        <p>Location: {{ profile_user.profile.location }}</p>
        <p>Followers: {{ profile_user.userprofile.followers.count }}</p>
        <a href="{% url 'account:follow_user' profile_user.username %}" class="btn btn-primary">Follow</a>
        <a href="{% url 'account:unfollow_user' profile_user.username %}" class="btn btn-danger">Unfollow</a>
      </div>
      <div class="col-md-8">
        <h3>Recipes</h3>
        {% for recipe in user_recipes %}
          <div class="card mb-3">
            <div class="card-body">
              <h5 class="card-title">{{ recipe.title }}</h5>
              <p class="card-text">{{ recipe.description }}</p>
              <!-- Add more fields as needed -->
            </div>
          </div>
        {% empty %}
          <p>No recipes found.</p>
        {% endfor %}
      </div>
    </div>

    <h3>Favorite Recipes</h3>
    <div class="row">
      {% for favorite_recipe in favorite_recipes %}
        <div class="col-md-4 mb-4">
          <div class="card">
            <img src="{{ favorite_recipe.image.url }}" class="card-img-top" alt="Recipe Image">
            <div class="card-body">
              <h5 class="card-title">{{ favorite_recipe.title }}</h5>
              <p class="card-text">{{ favorite_recipe.description }}</p>
              <!-- Add more fields as needed -->
            </div>
          </div>
        </div>
      {% empty %}
        <p>No favorite recipes found.</p>
      {% endfor %}
    </div>
  </div>



  <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Existing profile edit functionality
        const profileInfo = document.getElementById('profile-info');
        const profileForm = document.getElementById('profile-form');
        const editBtn = document.getElementById('edit-profile-btn');
        const cancelBtn = document.getElementById('cancel-edit-btn');
    
        if (editBtn) {
            editBtn.addEventListener('click', function() {
                profileInfo.style.display = 'none';
                profileForm.style.display = 'block';
            });
        }
    
        if (cancelBtn) {
            cancelBtn.addEventListener('click', function() {
                profileForm.style.display = 'none';
                profileInfo.style.display = 'block';
            });
        }
    
        // New account deletion functionality
        var deleteButton = document.querySelector('.btn-danger');
        if (deleteButton) {
            deleteButton.addEventListener('click', function(e) {
                e.preventDefault();
                var deleteModal = new bootstrap.Modal(document.getElementById('deleteAccountModal'));
                deleteModal.show();
            });
        }
    });
    </script>
{% endblock %}